\usepackage[dvipsnames]{xcolor}
\usepackage{tikz}
\usetikzlibrary{shapes.misc}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{tikzmark}
\usetikzlibrary{calc}

\usepackage{fontspec}
\setmainfont{Futura}
\Large

\definecolor{LCARS_GOLD}{HTML}{FFAA00}
\definecolor{LCARS_BLUE}{HTML}{7190C6}%{8ba4a6}%{577a83}%{7190C6}
\definecolor{LCARS_RED}{HTML}{B24F46}%{ef5035}
\definecolor{LCARS_GREEN}{HTML}{00A550}
\definecolor{LCARS_ORANGE}{HTML}{DE8443}
\definecolor{LCARS_PINK}{HTML}{FFB7C5}
\definecolor{LCARS_LIGHTGRAY}{HTML}{41444F}
\definecolor{LCARS_DARKGRAY}{HTML}{25272E}

\colorlet{blackfillcolor}{black}
\colorlet{darkfillcolor}{lightgray}
\colorlet{lightfillcolor}{white}
\colorlet{borderfillcolor}{lightgray}
\colorlet{subheadercolor}{black}
\colorlet{starcolor}{white}
\colorlet{bgcolor}{white}
\pagecolor{bgcolor}

%\colorlet{blackfillcolor}{black}
%\colorlet{darkfillcolor}{LCARS_RED}
%\colorlet{lightfillcolor}{lightgray!25}
%\colorlet{borderfillcolor}{lightgray}
%\colorlet{subheadercolor}{lightfillcolor}
%\colorlet{starcolor}{LCARS_LIGHTGRAY}
%\colorlet{bgcolor}{LCARS_DARKGRAY}
%\pagecolor{bgcolor}

% Define tikz styles
\tikzstyle{divine_favor}=[draw, very thick, diamond, anchor = north, inner sep = 0pt, minimum size=0.4cm, fill=lightfillcolor]
\tikzstyle{fate}=[draw, very thick, inner sep=0pt, minimum size=0.4cm, fill=lightfillcolor]
\tikzstyle{fate_dot}=[draw, very thick, inner sep=0pt, minimum size=0.125cm, circle, fill=black]
\tikzstyle{pathos}=[fate, circle, fill=lightfillcolor]

\tikzstyle{endeavour_box}=[draw, very thick, double=borderfillcolor, double distance=0.05cm, fill=lightfillcolor, inner sep=0.1cm, outer sep=0pt, minimum height=1.0cm, chamfered rectangle, chamfered rectangle sep=0.1cm,text height=1.5ex, text depth=-0.5ex]

\tikzstyle{short_header_box}=[endeavour_box, fill=darkfillcolor, anchor=north east, text width=2.125cm, chamfered rectangle corners={north west, south west}, align=right]

\tikzstyle{medium_header_box}=[endeavour_box, fill=darkfillcolor, anchor=north east, text width=2.5cm, chamfered rectangle corners={north west, south west}, align=right]

\tikzstyle{long_header_box}=[endeavour_box, anchor=north east, fill=darkfillcolor, text width=6.25cm, chamfered rectangle corners={north west, south west}, align=right]

\tikzstyle{tall_header_box}=[endeavour_box, anchor=north east, fill=darkfillcolor, text width=2.5cm, minimum height=1.75cm, chamfered rectangle corners={north west, south west}, align=right]

\tikzstyle{d_bar}=[fill=blackfillcolor, anchor=north west, minimum height=1.0cm, inner sep=0.1cm, fill=blackfillcolor]

\tikzstyle{attribute_field}=[endeavour_box, anchor=north west, text width=4.75cm, align=left, chamfered rectangle corners={north east, south east}]

\tikzstyle{tall_attribute_field}=[endeavour_box, anchor=north west, text width=9.08cm, align=left, minimum height=1.75cm, chamfered rectangle corners={north east, south east}]

\tikzstyle{aspect_field}=[endeavour_box, anchor=north west, text width=4.55cm, align=left, chamfered rectangle corners=none]

\tikzstyle{virtue_field}=[endeavour_box, anchor=north west, text width=2.45cm, align=left, chamfered rectangle corners={north east, south east}]

\tikzstyle{long_attribute_field}=[endeavour_box, anchor=north, text width=7.55cm, align=left, chamfered rectangle corners=all]


% Define header formats
\tikzset{title_header/.pic={
	\node[inner sep=0pt] at (0,0) {{\setmainfont[Scale=2.5]{TT Mussels-BoldItalic} \Huge #1}};
}}

\tikzset{subheader/.pic={
	\node[text height=1.5ex, text depth=0ex,, fill=bgcolor,inner sep=8pt] at (0,0) {{\setmainfont{Futura} \Large \textcolor{subheadercolor}{#1}}};
}}


% Define tikzpictures
\tikzset{character_attribute/.pic={
	\node[short_header_box] () at (-0.125,0) {{\Large #1\,}};
	\node[attribute_field] () at (0.125, 0) {};
	\node[d_bar] () at (3.875,0) {\textcolor{white}{d}};
	\node[attribute_field, fill=none] () at (0.125, 0) {};
}}

\tikzset{character_aspect/.pic={
	\node[short_header_box] () at (-0.125,0) {{\Large #1\,}};
	\node[aspect_field] () at (0.125cm, 0) {};
	\node[divine_favor] () at (5.075cm,-0.05cm) {};
	\node[divine_favor] () at (5.075cm,-0.5cm) {};
}}

\tikzset{domain/.pic={
	\node[long_attribute_field] () at (-2.6875, 0) {};
	\node[long_header_box] () at (-0.015cm,0) {{\Large #1\,\,}};
	\node[d_bar] () at (-0.125, 0) {\textcolor{white}{d}};
	\node[long_attribute_field, fill=none] () at (-2.6875, 0) {};
}}

\tikzset{diety/.pic={
	\node[short_header_box, fill=lightfillcolor] () at (0,0) {{\Large #1\,}};
	\node[divine_favor] () at (-0.0cm, -0.05cm) {};
	\node[divine_favor] () at (-0.0cm, -0.5cm) {};
}}

\tikzset{value/.pic={
	\node[medium_header_box] () at (-0.125,0) {{\Large #1\,}};
	\node[virtue_field] () at (0.125, 0cm) {};
}}

\tikzset{distinction/.pic={
	\node[tall_header_box] () at (-0.125,0) {{\Large Distinction\,}};
	\node[tall_attribute_field] () at (0.125, 0) {};
}}

\tikzset{character_sheet_1/.pic={
%  \path (current page.north west) --++ (1.0cm, 0cm) coordinate (tl) {};
%  \path (current page.south west) --++ (1.0cm, 0cm) coordinate (bl) {};
%  \path (current page.north east) --++ (-1.0cm, 0cm) coordinate (tr) {};
%  \path (current page.south east) --++ (-1.0cm, 0cm) coordinate (br) {};
%
%  \path (current page.north west) --++ (0cm, -1.0cm) coordinate (lt) {};
%  \path (current page.south west) --++ (0cm, 1.0cm) coordinate (lb) {};
%  \path (current page.north east) --++ (0cm, -1.0cm) coordinate (rt) {};
%  \path (current page.south east) --++ (0cm, 1.0) coordinate (rb) {};
%
%  \draw (tl) -- (bl);
%  \draw (tr) -- (br);
%  \draw (lt) -- (rt);
%  \draw (lb) -- (rb);

\path (0cm,0cm) --++ (0cm, 0cm) coordinate (nw) {};
\path (nw) --++ (7.4cm, 0cm) coordinate (n) {};
\path (nw) --++ (14.8cm, 0cm) coordinate (ne) {};
  
%  \path (current page.north) --++ (0cm, -1.05cm) node[endeavour_box, text height=1.25cm, text depth=0pt, anchor=north, minimum width=12.6cm, minimum height=1.75cm, fill=darkfillcolor] {\setmainfont[Scale=2.5]{TT Mussels-BoldItalic} \huge ENDEAVOUR};

  \path (n) --++ (0cm, -1.05cm) node[endeavour_box, text height=1.25cm, text depth=0pt, anchor=north, minimum width=12.6cm, minimum height=1.75cm, fill=darkfillcolor] {\setmainfont[Scale=2.5]{TT Mussels-BoldItalic} \huge ENDEAVOUR};

	\path (nw) --++ (3.75cm, -3.95cm) pic {character_attribute=Role};
	
  \path (nw) --++ (3.75cm, -5.2cm) pic {character_attribute=Name};

  \path (nw) --++ (3.75cm, -6.45cm) pic {character_aspect=Species};
  \path (nw) --++ (3.75cm, -7.7cm) pic {character_aspect=Heritage};
  
  % Portrait box
  \path (ne) --++ (-3.225cm, -3.45cm) pic {subheader=Notes};

  \path (ne) --++ (-3.225cm, -3.95cm) node[endeavour_box, anchor=north, minimum height = 4.75cm, minimum width = 4.25cm] {};

% Domains
\path (nw) --++ (5.0625cm, -9.7cm) pic {subheader={Domains}};

\path (nw) --++ (7.75cm, -10.2cm) pic {domain={Leadership \& Negotiation}};
\path (nw) --++ (7.75cm, -11.45cm) pic {domain={Science \& Medicine}};
\path (nw) --++ (7.75cm, -12.7cm) pic {domain={Operations \& Engineering}};
\path (nw) --++ (7.75cm, -13.95cm) pic {domain={Strategy \& Tactics}};

% Stress
\path (ne) --++ (-4.725cm, -9.7cm) pic {subheader={\,Stress\,}};

\path (ne) --++ (-4.725cm, -10.2cm) node[endeavour_box, anchor=north, minimum height = 4.75cm, minimum width = 1.25cm] {};


\foreach \i in {0,1,...,5}
	\path (ne) --++ (-4.725cm, -10.7cm - \i*0.75cm) node[pathos] (s\i) {};

\draw[very thick] (s0) -- (s1);
\draw[very thick] (s1) -- (s2);
\draw[very thick] (s2) -- (s3);
\draw[very thick] (s3) -- (s4);
\draw[very thick] (s4) -- (s5);

% Experience
\path (ne) --++ (-2.35cm, -9.7cm) pic {subheader=Experience};

\path (ne) --++ (-2.35cm, -10.2cm) node[endeavour_box, anchor=north, minimum height = 4.75cm, minimum width = 2.5cm] {};

\foreach \i in {0,1,...,5}
	\path (ne) --++ (-2.85cm, -10.7cm - \i*0.75cm) node[fate] (e\i) {};
\foreach \i in {0,1,...,5}
	\path (ne) --++ (-1.85cm, -10.7cm - \i*0.75cm) node[fate] (f\i) {};

\path (ne) --++ (-2.85cm, -10.7cm) node[fate_dot] (d0) {};
\path (ne) --++ (-2.85cm, -12.95cm) node[fate_dot] (d3) {};
\path (ne) --++ (-1.85cm, -11.45cm) node[fate_dot] (d7) {};

\draw[very thick] (e0) -- (e1);
\draw[very thick] (e1) -- (e2);
\draw[very thick] (e2) -- (e3);
\draw[very thick] (e3) -- (e4);
\draw[very thick] (e4) -- (e5);
\draw[very thick] (f0) -- (f1);
\draw[very thick] (f1) -- (f2);
\draw[very thick] (f2) -- (f3);
\draw[very thick] (f3) -- (f4);
\draw[very thick] (f4) -- (f5);

% Spacefaring Civilizations
\path (n) --++ (0cm, -15.95cm) pic {subheader=Spacefaring Civilizations};

\path (nw) --++ (3.61cm, -16.45cm) pic {diety=Terran};
\path (nw) --++ (6.97cm, -16.45cm) pic {diety};
\path (nw) --++ (10.33cm, -16.45cm) pic {diety};
\path (nw) --++ (13.69cm, -16.45cm) pic {diety};

\path (nw) --++ (3.61cm, -17.7cm) pic {diety};
\path (nw) --++ (6.97cm, -17.7cm) pic {diety};
\path (nw) --++ (10.33cm, -17.7cm) pic {diety};
\path (nw) --++ (13.69cm, -17.7cm) pic {diety};

\path (nw) --++ (3.61cm, -18.95cm) pic {diety};
\path (nw) --++ (6.97cm, -18.95cm) pic {diety};
\path (nw) --++ (10.33cm, -18.95cm) pic {diety};
\path (nw) --++ (13.69cm, -18.95cm) pic {diety};
}}

\tikzset{character_sheet_2/.pic={
%  \path (nw) --++ (1.0cm, 0cm) coordinate (tl) {};
%  \path (current page.south west) --++ (1.0cm, 0cm) coordinate (bl) {};
%  \path (ne) --++ (-1.0cm, 0cm) coordinate (tr) {};
%  \path (current page.south east) --++ (-1.0cm, 0cm) coordinate (br) {};
%
%  \path (nw) --++ (0cm, -1.0cm) coordinate (lt) {};
%  \path (current page.south west) --++ (0cm, 1.0cm) coordinate (lb) {};
%  \path (ne) --++ (0cm, -1.0cm) coordinate (rt) {};
%  \path (current page.south east) --++ (0cm, 1.0) coordinate (rb) {};
%
%  \draw (tl) -- (bl);
%  \draw (tr) -- (br);
%  \draw (lt) -- (rt);
%  \draw (lb) -- (rb);
  
  \path (0cm,0cm) --++ (0cm, 0cm) coordinate (nw) {};
\path (nw) --++ (7.4cm, 0cm) coordinate (n) {};
\path (nw) --++ (14.8cm, 0cm) coordinate (ne) {};

  %Distinction
\path (nw) --++ (4.11cm, -1.05cm) pic {distinction};
\foreach \i in {0, 1, ..., 11}
	\path (nw) --++ (4.8cm + \i*0.75cm, -1.55cm) node[fate] (g\i) {};
\foreach \i/\j in {0/1, 1/2, 2/3, 3/4, 4/5, 5/6, 6/7, 7/8, 8/9, 9/10, 10/11}
	\draw[very thick] (g\i) -- (g\j);

\foreach \i in {0,1,...,11}
	\path (nw) --++ (4.8cm + \i*0.75cm, -2.3cm) node[fate] (h\i) {};
\foreach \i/\j in {0/1, 1/2, 2/3, 3/4, 4/5, 5/6, 6/7, 7/8, 8/9, 9/10, 10/11}
	\draw[very thick] (h\i) -- (h\j);

\path (nw) --++ (10.05cm, -1.55cm) node[fate_dot] {};
\path (nw) --++ (7.05cm, -2.3cm) node[fate_dot] {};
\path (nw) --++ (13.05cm, -2.3cm) node[fate_dot] {};

% Bonds
\path (nw) --++ (3.2cm, -3.45cm) pic {subheader={Bonds}};

\foreach \i in {0,1,...,8}
	\path (nw) --++ (3.2cm, -3.95cm - \i*1.25cm) node[endeavour_box, anchor=north, minimum height = 1cm, minimum width = 4.25cm] {};

% Discoveries
\path (ne) --++ (-4.95cm, -3.45cm) pic {subheader=Artifacts and Discoveries};

\foreach \i in {0,1,...,8} {
	\path (ne) --++ (-4.95cm, -3.95cm - \i*1.25cm) node[endeavour_box, anchor=north, minimum height = 1cm, minimum width = 7.75cm] {};
	\path (ne) --++ (-8.275cm, -3.95cm - \i*1.25cm - 0.5cm) node[fate] {};
}

%Virtues
\path (n) --++ (0cm, -15.95cm) pic {subheader={\,Core Values\,}};

\path (nw) --++ (4.11cm, -16.45cm) pic {value=Curiosity};
\path (nw) --++ (10.74cm, -16.45cm) pic {value=Integrity};

\path (nw) --++ (4.11cm, -17.7cm) pic {value=Fairness};
\path (nw) --++ (10.74cm, -17.7cm) pic {value=Courage};

\path (nw) --++ (4.11cm, -18.95cm) pic {value=\phantom{abcde}};
\path (nw) --++ (10.74cm, -18.95cm) pic{value=\phantom{abcde}};
}}